enable subgroups;
const workgroup_size_x: u32 = 256;
const workgroup_size_y: u32 = 1;
const workgroup_size_z: u32 = 1;
@group(0) @binding(0) var<storage, read> a: array<f32>;
@group(0) @binding(1) var<storage, read> b: array<vec4<f32>>;
@group(0) @binding(2) var<storage, read_write> output: array<vec4<f32>>;
struct Uniforms {
  a_shape: vec2<u32>,
  a_stride: u32,
  b_shape: vec2<u32>,
  b_stride: u32,
  output_shape: vec3<u32>,
  output_stride: vec2<u32>,
  dim_a_outer: u32,
  dim_b_outer: u32,
  dim_inner: u32
};
@group(0) @binding(3) var<uniform> uniforms: Uniforms;

alias a_value_t = f32;
alias a_indices_t = vec2<u32>;
alias a_element_t = f32;
fn i2o_a(indices : a_indices_t)->u32 {
  return indices[0] * uniforms.a_stride + indices[1];
}
fn get_a_by_indices(indices_fnarg: a_indices_t)->a_value_t {
  return a[i2o_a(indices_fnarg)];
}
alias b_value_t = vec4<f32>;
alias b_indices_t = vec2<u32>;
alias b_element_t = f32;
fn i2o_b(indices : b_indices_t)->u32 {
  return indices[0] * uniforms.b_stride + indices[1];
}
fn get_b_by_indices(indices_fnarg: b_indices_t)->b_value_t {
  return b[i2o_b(indices_fnarg)];
}
alias output_value_t = vec4<f32>;
alias output_indices_t = vec3<u32>;
alias output_element_t = f32;
fn i2o_output(indices : output_indices_t)->u32 {
  return indices[0] * uniforms.output_stride[0] + indices[1] * uniforms.output_stride[1] + indices[2];
}
fn set_output_by_indices(indices: output_indices_t, value: output_value_t) {
  output[i2o_output(indices)]=value;
}
alias batch_dims_indices_t = u32;

fn mm_readA(batch: i32, row: i32, colIn: i32 , batch_indices: batch_dims_indices_t) -> output_element_t {
     var value = output_element_t(0);
    let col = colIn * 1;
    if(row < i32(uniforms.dim_a_outer) && col < i32(uniforms.dim_inner)) {
        var a_indices: a_indices_t;

a_indices[0]=u32(row);
a_indices[1]=u32(colIn);
        value = get_a_by_indices(a_indices);
    }
    return value;
}

fn mm_readB(batch: i32, row: i32, colIn: i32 , batch_indices: batch_dims_indices_t) -> vec4<output_element_t> {
     var value = vec4<output_element_t>(0);
    let col = colIn * 4;
    if(row < i32(uniforms.dim_inner) && col < i32(uniforms.dim_b_outer)) {
        var b_indices: b_indices_t;

b_indices[0]=u32(row);
b_indices[1]=u32(colIn);
        value = get_b_by_indices(b_indices);
    }
    return value;
}

fn mm_write(batch: i32, row: i32, colIn: i32, valueIn: output_value_t) {
  let col = colIn * 4;
  if(row < i32(uniforms.dim_a_outer) && col < i32(uniforms.dim_b_outer)) {
    var value = valueIn;
    let coords = vec3(u32(batch), u32(row), u32(colIn));
    
    set_output_by_indices(coords, value);
  }
}

var<workgroup> mm_Bsub: array<array<b_value_t, 32>, 32>;
@compute @workgroup_size(workgroup_size_x, workgroup_size_y, workgroup_size_z)
fn main(@builtin(global_invocation_id) global_id : vec3<u32>,
        @builtin(workgroup_id) workgroup_id : vec3<u32>,
        @builtin(local_invocation_index) local_idx : u32,
        @builtin(local_invocation_id) local_id : vec3<u32>,
        @builtin(subgroup_invocation_id) sg_id : u32,
        @builtin(subgroup_size) sg_size : u32,
        @builtin(num_workgroups) num_workgroups : vec3<u32>) {
  let workgroup_idx = workgroup_id.z * num_workgroups[0] * num_workgroups[1] + workgroup_id.y * num_workgroups[0] + workgroup_id.x;
  let global_idx = workgroup_idx * (workgroup_size_x * workgroup_size_y * workgroup_size_z) + local_idx;
  let workgroupIdXStride = (uniforms.dim_b_outer - 1) / 128 + 1;
  let workgroupIdYStride = (uniforms.dim_a_outer - 1) / 64 + 1;
  let batch = i32(workgroup_idx / (workgroupIdXStride * workgroupIdYStride));
  let workgroupIdXY = workgroup_idx % (workgroupIdXStride * workgroupIdYStride);
  let workgroupIdX = workgroupIdXY % workgroupIdXStride;
  let workgroupIdY = workgroupIdXY / workgroupIdXStride;
  let tileRow = i32(local_id.x / 32) * 8;
  let tileCol = i32(local_id.x % 32);
  let localRow = i32(local_id.x / 32);
  let batchIndices = u32(batch);
  let globalRowStart = i32(workgroupIdY) * 64 + tileRow;
  let globalColStart = i32(workgroupIdX) * 32 + tileCol;
  let numTiles = (uniforms.dim_inner - 1) / 32 + 1;
  var kStart = 0;
  var aCol = 0;
  var BCache: vec4<b_element_t>;
  var acc_0 = vec4<output_element_t>(0);
  var a_val_0 = a_value_t(0);
  var acc_1 = vec4<output_element_t>(0);
  var a_val_1 = a_value_t(0);
  var acc_2 = vec4<output_element_t>(0);
  var a_val_2 = a_value_t(0);
  var acc_3 = vec4<output_element_t>(0);
  var a_val_3 = a_value_t(0);
  var acc_4 = vec4<output_element_t>(0);
  var a_val_4 = a_value_t(0);
  var acc_5 = vec4<output_element_t>(0);
  var a_val_5 = a_value_t(0);
  var acc_6 = vec4<output_element_t>(0);
  var a_val_6 = a_value_t(0);
  var acc_7 = vec4<output_element_t>(0);
  var a_val_7 = a_value_t(0);
  for (var t = 0; t < i32(numTiles); t++) {
    let loadRowsPerThread = 4;
    for (var innerRow = 0; innerRow < loadRowsPerThread; innerRow++) {
      let inputRow = loadRowsPerThread * localRow + innerRow;
      let inputCol = tileCol;
      mm_Bsub[inputRow][inputCol] = mm_readB(batch, kStart + inputRow, globalColStart, batchIndices);
    }
    workgroupBarrier();
    aCol = kStart + tileCol % i32(sg_size);
    if (sg_size == 8) {
      a_val_0 = mm_readA(batch, globalRowStart + 0, aCol, batchIndices);
      a_val_1 = mm_readA(batch, globalRowStart + 1, aCol, batchIndices);
      a_val_2 = mm_readA(batch, globalRowStart + 2, aCol, batchIndices);
      a_val_3 = mm_readA(batch, globalRowStart + 3, aCol, batchIndices);
      a_val_4 = mm_readA(batch, globalRowStart + 4, aCol, batchIndices);
      a_val_5 = mm_readA(batch, globalRowStart + 5, aCol, batchIndices);
      a_val_6 = mm_readA(batch, globalRowStart + 6, aCol, batchIndices);
      a_val_7 = mm_readA(batch, globalRowStart + 7, aCol, batchIndices);
      aCol += 8;
      BCache = mm_Bsub[0][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 0) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 0) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 0) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 0) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 0) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 0) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 0) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 0) * BCache;
      BCache = mm_Bsub[1][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 1) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 1) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 1) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 1) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 1) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 1) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 1) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 1) * BCache;
      BCache = mm_Bsub[2][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 2) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 2) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 2) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 2) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 2) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 2) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 2) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 2) * BCache;
      BCache = mm_Bsub[3][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 3) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 3) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 3) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 3) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 3) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 3) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 3) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 3) * BCache;
      BCache = mm_Bsub[4][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 4) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 4) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 4) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 4) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 4) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 4) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 4) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 4) * BCache;
      BCache = mm_Bsub[5][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 5) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 5) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 5) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 5) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 5) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 5) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 5) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 5) * BCache;
      BCache = mm_Bsub[6][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 6) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 6) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 6) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 6) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 6) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 6) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 6) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 6) * BCache;
      BCache = mm_Bsub[7][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 7) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 7) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 7) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 7) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 7) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 7) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 7) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 7) * BCache;
      a_val_0 = mm_readA(batch, globalRowStart + 0, aCol, batchIndices);
      a_val_1 = mm_readA(batch, globalRowStart + 1, aCol, batchIndices);
      a_val_2 = mm_readA(batch, globalRowStart + 2, aCol, batchIndices);
      a_val_3 = mm_readA(batch, globalRowStart + 3, aCol, batchIndices);
      a_val_4 = mm_readA(batch, globalRowStart + 4, aCol, batchIndices);
      a_val_5 = mm_readA(batch, globalRowStart + 5, aCol, batchIndices);
      a_val_6 = mm_readA(batch, globalRowStart + 6, aCol, batchIndices);
      a_val_7 = mm_readA(batch, globalRowStart + 7, aCol, batchIndices);
      aCol += 8;
      BCache = mm_Bsub[8][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 0) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 0) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 0) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 0) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 0) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 0) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 0) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 0) * BCache;
      BCache = mm_Bsub[9][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 1) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 1) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 1) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 1) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 1) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 1) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 1) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 1) * BCache;
      BCache = mm_Bsub[10][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 2) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 2) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 2) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 2) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 2) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 2) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 2) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 2) * BCache;
      BCache = mm_Bsub[11][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 3) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 3) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 3) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 3) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 3) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 3) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 3) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 3) * BCache;
      BCache = mm_Bsub[12][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 4) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 4) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 4) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 4) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 4) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 4) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 4) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 4) * BCache;
      BCache = mm_Bsub[13][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 5) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 5) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 5) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 5) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 5) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 5) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 5) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 5) * BCache;
      BCache = mm_Bsub[14][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 6) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 6) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 6) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 6) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 6) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 6) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 6) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 6) * BCache;
      BCache = mm_Bsub[15][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 7) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 7) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 7) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 7) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 7) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 7) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 7) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 7) * BCache;
      a_val_0 = mm_readA(batch, globalRowStart + 0, aCol, batchIndices);
      a_val_1 = mm_readA(batch, globalRowStart + 1, aCol, batchIndices);
      a_val_2 = mm_readA(batch, globalRowStart + 2, aCol, batchIndices);
      a_val_3 = mm_readA(batch, globalRowStart + 3, aCol, batchIndices);
      a_val_4 = mm_readA(batch, globalRowStart + 4, aCol, batchIndices);
      a_val_5 = mm_readA(batch, globalRowStart + 5, aCol, batchIndices);
      a_val_6 = mm_readA(batch, globalRowStart + 6, aCol, batchIndices);
      a_val_7 = mm_readA(batch, globalRowStart + 7, aCol, batchIndices);
      aCol += 8;
      BCache = mm_Bsub[16][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 0) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 0) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 0) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 0) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 0) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 0) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 0) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 0) * BCache;
      BCache = mm_Bsub[17][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 1) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 1) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 1) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 1) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 1) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 1) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 1) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 1) * BCache;
      BCache = mm_Bsub[18][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 2) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 2) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 2) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 2) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 2) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 2) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 2) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 2) * BCache;
      BCache = mm_Bsub[19][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 3) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 3) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 3) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 3) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 3) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 3) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 3) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 3) * BCache;
      BCache = mm_Bsub[20][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 4) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 4) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 4) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 4) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 4) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 4) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 4) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 4) * BCache;
      BCache = mm_Bsub[21][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 5) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 5) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 5) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 5) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 5) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 5) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 5) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 5) * BCache;
      BCache = mm_Bsub[22][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 6) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 6) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 6) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 6) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 6) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 6) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 6) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 6) * BCache;
      BCache = mm_Bsub[23][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 7) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 7) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 7) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 7) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 7) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 7) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 7) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 7) * BCache;
      a_val_0 = mm_readA(batch, globalRowStart + 0, aCol, batchIndices);
      a_val_1 = mm_readA(batch, globalRowStart + 1, aCol, batchIndices);
      a_val_2 = mm_readA(batch, globalRowStart + 2, aCol, batchIndices);
      a_val_3 = mm_readA(batch, globalRowStart + 3, aCol, batchIndices);
      a_val_4 = mm_readA(batch, globalRowStart + 4, aCol, batchIndices);
      a_val_5 = mm_readA(batch, globalRowStart + 5, aCol, batchIndices);
      a_val_6 = mm_readA(batch, globalRowStart + 6, aCol, batchIndices);
      a_val_7 = mm_readA(batch, globalRowStart + 7, aCol, batchIndices);
      aCol += 8;
      BCache = mm_Bsub[24][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 0) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 0) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 0) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 0) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 0) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 0) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 0) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 0) * BCache;
      BCache = mm_Bsub[25][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 1) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 1) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 1) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 1) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 1) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 1) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 1) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 1) * BCache;
      BCache = mm_Bsub[26][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 2) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 2) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 2) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 2) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 2) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 2) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 2) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 2) * BCache;
      BCache = mm_Bsub[27][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 3) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 3) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 3) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 3) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 3) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 3) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 3) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 3) * BCache;
      BCache = mm_Bsub[28][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 4) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 4) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 4) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 4) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 4) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 4) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 4) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 4) * BCache;
      BCache = mm_Bsub[29][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 5) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 5) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 5) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 5) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 5) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 5) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 5) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 5) * BCache;
      BCache = mm_Bsub[30][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 6) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 6) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 6) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 6) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 6) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 6) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 6) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 6) * BCache;
      BCache = mm_Bsub[31][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 7) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 7) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 7) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 7) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 7) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 7) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 7) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 7) * BCache;
    }
    if (sg_size == 16) {
      a_val_0 = mm_readA(batch, globalRowStart + 0, aCol, batchIndices);
      a_val_1 = mm_readA(batch, globalRowStart + 1, aCol, batchIndices);
      a_val_2 = mm_readA(batch, globalRowStart + 2, aCol, batchIndices);
      a_val_3 = mm_readA(batch, globalRowStart + 3, aCol, batchIndices);
      a_val_4 = mm_readA(batch, globalRowStart + 4, aCol, batchIndices);
      a_val_5 = mm_readA(batch, globalRowStart + 5, aCol, batchIndices);
      a_val_6 = mm_readA(batch, globalRowStart + 6, aCol, batchIndices);
      a_val_7 = mm_readA(batch, globalRowStart + 7, aCol, batchIndices);
      aCol += 16;
      BCache = mm_Bsub[0][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 0) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 0) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 0) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 0) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 0) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 0) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 0) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 0) * BCache;
      BCache = mm_Bsub[1][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 1) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 1) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 1) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 1) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 1) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 1) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 1) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 1) * BCache;
      BCache = mm_Bsub[2][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 2) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 2) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 2) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 2) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 2) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 2) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 2) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 2) * BCache;
      BCache = mm_Bsub[3][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 3) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 3) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 3) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 3) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 3) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 3) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 3) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 3) * BCache;
      BCache = mm_Bsub[4][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 4) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 4) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 4) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 4) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 4) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 4) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 4) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 4) * BCache;
      BCache = mm_Bsub[5][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 5) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 5) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 5) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 5) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 5) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 5) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 5) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 5) * BCache;
      BCache = mm_Bsub[6][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 6) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 6) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 6) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 6) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 6) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 6) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 6) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 6) * BCache;
      BCache = mm_Bsub[7][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 7) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 7) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 7) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 7) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 7) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 7) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 7) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 7) * BCache;
      BCache = mm_Bsub[8][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 8) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 8) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 8) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 8) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 8) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 8) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 8) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 8) * BCache;
      BCache = mm_Bsub[9][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 9) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 9) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 9) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 9) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 9) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 9) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 9) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 9) * BCache;
      BCache = mm_Bsub[10][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 10) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 10) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 10) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 10) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 10) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 10) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 10) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 10) * BCache;
      BCache = mm_Bsub[11][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 11) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 11) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 11) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 11) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 11) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 11) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 11) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 11) * BCache;
      BCache = mm_Bsub[12][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 12) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 12) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 12) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 12) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 12) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 12) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 12) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 12) * BCache;
      BCache = mm_Bsub[13][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 13) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 13) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 13) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 13) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 13) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 13) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 13) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 13) * BCache;
      BCache = mm_Bsub[14][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 14) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 14) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 14) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 14) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 14) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 14) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 14) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 14) * BCache;
      BCache = mm_Bsub[15][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 15) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 15) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 15) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 15) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 15) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 15) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 15) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 15) * BCache;
      a_val_0 = mm_readA(batch, globalRowStart + 0, aCol, batchIndices);
      a_val_1 = mm_readA(batch, globalRowStart + 1, aCol, batchIndices);
      a_val_2 = mm_readA(batch, globalRowStart + 2, aCol, batchIndices);
      a_val_3 = mm_readA(batch, globalRowStart + 3, aCol, batchIndices);
      a_val_4 = mm_readA(batch, globalRowStart + 4, aCol, batchIndices);
      a_val_5 = mm_readA(batch, globalRowStart + 5, aCol, batchIndices);
      a_val_6 = mm_readA(batch, globalRowStart + 6, aCol, batchIndices);
      a_val_7 = mm_readA(batch, globalRowStart + 7, aCol, batchIndices);
      aCol += 16;
      BCache = mm_Bsub[16][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 0) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 0) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 0) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 0) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 0) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 0) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 0) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 0) * BCache;
      BCache = mm_Bsub[17][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 1) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 1) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 1) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 1) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 1) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 1) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 1) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 1) * BCache;
      BCache = mm_Bsub[18][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 2) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 2) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 2) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 2) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 2) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 2) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 2) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 2) * BCache;
      BCache = mm_Bsub[19][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 3) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 3) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 3) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 3) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 3) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 3) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 3) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 3) * BCache;
      BCache = mm_Bsub[20][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 4) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 4) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 4) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 4) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 4) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 4) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 4) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 4) * BCache;
      BCache = mm_Bsub[21][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 5) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 5) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 5) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 5) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 5) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 5) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 5) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 5) * BCache;
      BCache = mm_Bsub[22][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 6) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 6) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 6) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 6) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 6) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 6) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 6) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 6) * BCache;
      BCache = mm_Bsub[23][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 7) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 7) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 7) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 7) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 7) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 7) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 7) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 7) * BCache;
      BCache = mm_Bsub[24][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 8) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 8) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 8) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 8) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 8) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 8) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 8) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 8) * BCache;
      BCache = mm_Bsub[25][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 9) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 9) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 9) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 9) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 9) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 9) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 9) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 9) * BCache;
      BCache = mm_Bsub[26][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 10) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 10) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 10) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 10) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 10) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 10) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 10) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 10) * BCache;
      BCache = mm_Bsub[27][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 11) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 11) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 11) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 11) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 11) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 11) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 11) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 11) * BCache;
      BCache = mm_Bsub[28][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 12) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 12) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 12) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 12) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 12) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 12) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 12) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 12) * BCache;
      BCache = mm_Bsub[29][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 13) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 13) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 13) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 13) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 13) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 13) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 13) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 13) * BCache;
      BCache = mm_Bsub[30][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 14) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 14) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 14) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 14) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 14) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 14) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 14) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 14) * BCache;
      BCache = mm_Bsub[31][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 15) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 15) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 15) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 15) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 15) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 15) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 15) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 15) * BCache;
    }
    if (sg_size == 32) {
      a_val_0 = mm_readA(batch, globalRowStart + 0, aCol, batchIndices);
      a_val_1 = mm_readA(batch, globalRowStart + 1, aCol, batchIndices);
      a_val_2 = mm_readA(batch, globalRowStart + 2, aCol, batchIndices);
      a_val_3 = mm_readA(batch, globalRowStart + 3, aCol, batchIndices);
      a_val_4 = mm_readA(batch, globalRowStart + 4, aCol, batchIndices);
      a_val_5 = mm_readA(batch, globalRowStart + 5, aCol, batchIndices);
      a_val_6 = mm_readA(batch, globalRowStart + 6, aCol, batchIndices);
      a_val_7 = mm_readA(batch, globalRowStart + 7, aCol, batchIndices);
      aCol += 32;
      BCache = mm_Bsub[0][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 0) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 0) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 0) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 0) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 0) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 0) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 0) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 0) * BCache;
      BCache = mm_Bsub[1][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 1) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 1) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 1) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 1) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 1) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 1) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 1) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 1) * BCache;
      BCache = mm_Bsub[2][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 2) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 2) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 2) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 2) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 2) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 2) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 2) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 2) * BCache;
      BCache = mm_Bsub[3][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 3) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 3) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 3) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 3) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 3) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 3) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 3) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 3) * BCache;
      BCache = mm_Bsub[4][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 4) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 4) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 4) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 4) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 4) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 4) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 4) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 4) * BCache;
      BCache = mm_Bsub[5][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 5) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 5) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 5) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 5) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 5) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 5) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 5) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 5) * BCache;
      BCache = mm_Bsub[6][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 6) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 6) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 6) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 6) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 6) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 6) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 6) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 6) * BCache;
      BCache = mm_Bsub[7][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 7) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 7) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 7) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 7) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 7) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 7) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 7) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 7) * BCache;
      BCache = mm_Bsub[8][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 8) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 8) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 8) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 8) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 8) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 8) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 8) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 8) * BCache;
      BCache = mm_Bsub[9][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 9) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 9) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 9) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 9) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 9) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 9) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 9) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 9) * BCache;
      BCache = mm_Bsub[10][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 10) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 10) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 10) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 10) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 10) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 10) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 10) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 10) * BCache;
      BCache = mm_Bsub[11][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 11) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 11) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 11) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 11) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 11) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 11) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 11) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 11) * BCache;
      BCache = mm_Bsub[12][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 12) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 12) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 12) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 12) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 12) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 12) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 12) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 12) * BCache;
      BCache = mm_Bsub[13][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 13) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 13) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 13) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 13) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 13) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 13) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 13) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 13) * BCache;
      BCache = mm_Bsub[14][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 14) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 14) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 14) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 14) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 14) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 14) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 14) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 14) * BCache;
      BCache = mm_Bsub[15][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 15) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 15) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 15) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 15) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 15) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 15) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 15) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 15) * BCache;
      BCache = mm_Bsub[16][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 16) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 16) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 16) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 16) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 16) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 16) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 16) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 16) * BCache;
      BCache = mm_Bsub[17][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 17) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 17) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 17) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 17) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 17) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 17) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 17) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 17) * BCache;
      BCache = mm_Bsub[18][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 18) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 18) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 18) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 18) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 18) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 18) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 18) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 18) * BCache;
      BCache = mm_Bsub[19][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 19) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 19) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 19) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 19) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 19) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 19) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 19) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 19) * BCache;
      BCache = mm_Bsub[20][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 20) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 20) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 20) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 20) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 20) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 20) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 20) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 20) * BCache;
      BCache = mm_Bsub[21][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 21) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 21) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 21) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 21) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 21) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 21) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 21) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 21) * BCache;
      BCache = mm_Bsub[22][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 22) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 22) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 22) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 22) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 22) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 22) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 22) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 22) * BCache;
      BCache = mm_Bsub[23][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 23) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 23) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 23) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 23) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 23) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 23) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 23) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 23) * BCache;
      BCache = mm_Bsub[24][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 24) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 24) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 24) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 24) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 24) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 24) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 24) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 24) * BCache;
      BCache = mm_Bsub[25][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 25) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 25) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 25) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 25) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 25) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 25) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 25) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 25) * BCache;
      BCache = mm_Bsub[26][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 26) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 26) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 26) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 26) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 26) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 26) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 26) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 26) * BCache;
      BCache = mm_Bsub[27][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 27) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 27) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 27) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 27) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 27) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 27) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 27) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 27) * BCache;
      BCache = mm_Bsub[28][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 28) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 28) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 28) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 28) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 28) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 28) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 28) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 28) * BCache;
      BCache = mm_Bsub[29][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 29) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 29) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 29) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 29) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 29) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 29) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 29) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 29) * BCache;
      BCache = mm_Bsub[30][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 30) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 30) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 30) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 30) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 30) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 30) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 30) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 30) * BCache;
      BCache = mm_Bsub[31][tileCol];
      acc_0 += subgroupBroadcast(a_val_0, 31) * BCache;
      acc_1 += subgroupBroadcast(a_val_1, 31) * BCache;
      acc_2 += subgroupBroadcast(a_val_2, 31) * BCache;
      acc_3 += subgroupBroadcast(a_val_3, 31) * BCache;
      acc_4 += subgroupBroadcast(a_val_4, 31) * BCache;
      acc_5 += subgroupBroadcast(a_val_5, 31) * BCache;
      acc_6 += subgroupBroadcast(a_val_6, 31) * BCache;
      acc_7 += subgroupBroadcast(a_val_7, 31) * BCache;
    }
    kStart = kStart + 32;
    workgroupBarrier();
  }
  mm_write(batch, globalRowStart + 0, globalColStart, acc_0);
  mm_write(batch, globalRowStart + 1, globalColStart, acc_1);
  mm_write(batch, globalRowStart + 2, globalColStart, acc_2);
  mm_write(batch, globalRowStart + 3, globalColStart, acc_3);
  mm_write(batch, globalRowStart + 4, globalColStart, acc_4);
  mm_write(batch, globalRowStart + 5, globalColStart, acc_5);
  mm_write(batch, globalRowStart + 6, globalColStart, acc_6);
  mm_write(batch, globalRowStart + 7, globalColStart, acc_7);

}
